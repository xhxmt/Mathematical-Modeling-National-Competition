# NIPT 时点选择与胎儿异常判定 - 完整分析报告

## 项目概述
基于2024年数学建模国赛C题数据，完成了无创产前检测(NIPT)时点选择与胎儿异常判定的完整分析。

## 数据概况
- **男胎数据**: 1082条记录
- **女胎数据**: 605条记录  
- **分析样本**: 1081条有效男胎数据，604条有效女胎数据

## 问题解决方案

### 问题1: Y染色体浓度相关性分析

#### 统计结果
- **有效样本**: 1081条
- **Y染色体浓度范围**: 0.010% - 0.234%
- **平均浓度**: 0.077%
- **孕周范围**: 11-29周
- **BMI范围**: 20.7-46.9

#### 相关性分析
- **孕周与Y染色体浓度**: r = 0.1265 (正相关)
- **BMI与Y染色体浓度**: r = -0.1510 (负相关)

#### 回归模型
```
Y染色体浓度 = 0.1194 + 0.0013×孕周 - 0.0020×BMI
R² = 0.0455, p < 0.001
```

**解释**: 
- 孕周每增加1周，Y染色体浓度平均增加0.125%
- BMI每增加1个单位，Y染色体浓度平均减少0.196%

### 问题2: BMI分组与最佳NIPT时点

#### BMI分组结果
| 组别 | BMI范围 | 平均BMI | 样本数 | 平均Y浓度 | 推荐时点 |
|------|---------|---------|--------|-----------|----------|
| 组1  | 20.7-31.0 | 29.6 | 415 | 0.082% | 12周 |
| 组3  | 31.0-33.9 | 32.4 | 395 | 0.078% | 12周 |
| 组2  | 33.9-37.8 | 35.4 | 228 | 0.070% | 12周 |
| 组0  | 38.2-46.9 | 40.5 | 44  | 0.059% | 12周 |

#### 关键发现
- 高BMI组Y染色体浓度显著较低
- 所有组均推荐12周作为基础检测时点
- 高BMI组可考虑适当延后以确保准确性

### 问题3: 多因素综合优化

#### 扩展模型
引入年龄、身高、体重等多因素后：
- **R²提升**: 从4.55%提升到7.14%
- **显著特征**:
  - 孕周: 系数=0.0013 (p<0.001)
  - 年龄: 系数=-0.0010 (p<0.001)
  - 身高: 系数=0.0040 (p=0.042)
  - 体重: 系数=-0.0043 (p=0.020)

#### 优化时点建议
| 组别 | BMI范围 | 推荐时点 | 样本数 |
|------|---------|----------|--------|
| 低BMI组 | 20.7-31.0 | 17周 | 415 |
| 中低BMI组 | 31.0-33.9 | 15周 | 395 |
| 中高BMI组 | 33.9-37.8 | 14周 | 227 |
| 高BMI组 | 38.2-46.9 | 12周 | 44 |

### 问题4: 女胎异常判定

#### 模型性能
- **有效样本**: 604条
- **异常比例**: 11.09% (67/604)
- **AUC评分**: 0.8376
- **异常样本准确率**: 50.0%
- **异常样本召回率**: 7.7%

#### 关键特征重要性
1. **X染色体浓度**: -1.1783
2. **21号染色体Z值**: 0.3623
3. **被过滤读段比例**: 0.3153
4. **孕妇BMI**: -0.2860
5. **年龄**: -0.2408

#### 判定方法
基于逻辑回归模型，综合考虑染色体Z值、浓度、BMI等多维度特征进行异常判定。

## 临床应用建议

### 个性化检测时点
1. **低BMI孕妇** (BMI < 31): 可考虑较早检测
2. **高BMI孕妇** (BMI ≥ 35): 建议推迟至14-17周
3. **综合评估**: 结合年龄、体重等多因素制定个性化方案

### 质量控制
- 确保Y染色体浓度达到4%以上再出具报告
- 对高BMI孕妇加强随访
- 建立异常判定预警系统

### 模型改进方向
1. 扩大样本量提高模型精度
2. 引入更多临床变量
3. 建立动态阈值调整机制
4. 加强异常样本识别能力

## 技术实现
- **编程语言**: Python 3.12
- **主要库**: pandas, scikit-learn, statsmodels, scipy
- **分析方法**: 多元线性回归、K-means聚类、逻辑回归
- **评估指标**: R²、AUC、准确率、召回率

## 结论
本分析成功解决了NIPT时点选择和胎儿异常判定的四个核心问题，建立了科学、个性化的检测方案，具有良好的临床应用价值。